{"cells":[{"cell_type":"markdown","metadata":{"id":"IB9xmk6GmX8Z"},"source":["# Autoencoder for the Kolmogorov Flow\n","\n","In this session, you will need to use what you learned in the previous notebooks to develop a particular neural network called an autoencoder.\n","The Kolmogorov flow is governed by the following equation:\n","\\begin{align}\n","    \\nabla \\cdot \\mathbf{u} &= 0\\\\\n","   \\partial_t \\mathbf{u} + \\mathbf{u} \\cdot \\nabla \\mathbf{u} &= -\\nabla p + \\frac{1}{Re} \\Delta \\mathbf{u} + \\mathbf{f}\n","\\end{align}\n","where $\\mathbf{u} = (u,v)$ is the flow velocity over the domain $(x,y)\\in \\Omega = [0,2\\pi]\\times[0,2\\pi]$ with periodic boundary conditions and $p$ is the pressure field.\n","In the Kolmogorov flow, the forcing term, $\\mathbf{f}$ is $\\mathbf{f} = (sin(k_fy),0)$.\n","\n","The Kolmogorov flow admits a laminar solution $u= \\frac{Re}{k_f^2} \\sin(k_fy)$, $v=0$ which is unstable for large enough $Re$ and $k_f$."]},{"cell_type":"markdown","metadata":{"id":"4dHP6_9cmX8d"},"source":["## 1. Import librairies"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eA5vwZ6XmX8e"},"outputs":[],"source":["import numpy as np\n","import tensorflow as tf\n","# from datetime import datetime\n","import matplotlib.pyplot as plt\n","import h5py\n","from tensorflow.keras.layers import Input, Dense, Conv2D, MaxPool2D, UpSampling2D, concatenate, BatchNormalization, Conv2DTranspose, Flatten, Reshape, AveragePooling2D\n","from tensorflow.keras.optimizers import Adam \n","\n"]},{"cell_type":"markdown","metadata":{"id":"IEm7mhXKmX8f"},"source":["# 2. Read dataset"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PwPP52lnczsQ","executionInfo":{"status":"ok","timestamp":1642776855687,"user_tz":-60,"elapsed":13932,"user":{"displayName":"Mick Hekkema","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"14588855259162105764"}},"outputId":"942cd07a-c311-4dd0-c141-87e7d4676683"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JuUg6C1OmX8f","executionInfo":{"status":"ok","timestamp":1642777524339,"user_tz":-60,"elapsed":331,"user":{"displayName":"Mick Hekkema","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"14588855259162105764"}},"outputId":"14ba1921-e8ba-43e4-c9db-d97c976c9923","colab":{"base_uri":"https://localhost:8080/"}},"outputs":[{"output_type":"stream","name":"stdout","text":["(1000, 24, 24, 1)\n"]}],"source":["hf = h5py.File('/content/drive/MyDrive/Kolmogorov_Re50.0_T2000_DT01.h5','r')\n","Nx = 24\n","Nu = 1\n","t = np.array(hf.get('t'))\n","u_all = np.zeros((Nx,Nx,len(t),Nu))\n","u_all[:,:,:,0] = np.array(hf.get('u_refined'))\n","# u_all[:,:,:,1] = np.array(hf.get('v_refined'))\n","u_all = np.transpose(u_all,[2,0,1,3])\n","hf.close()\n","print(u_all.shape)\n","\n","# normalize data\n","u_min = np.amin(u_all[:,:,:,0])\n","u_max = np.amax(u_all[:,:,:,0])\n","u_all[:,:,:,0] = (u_all[:,:,:,0] - u_min) / (u_max - u_min)\n","if Nu==2:\n","    v_min = np.amin(u_all[:,:,:,1])\n","    v_max = np.amax(u_all[:,:,:,1])\n","    u_all[:,:,:,1] = (u_all[:,:,:,1] - v_min) / (v_max - v_min)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"scrolled":false,"id":"rhqnwjf4mX8g","colab":{"base_uri":"https://localhost:8080/","height":282},"executionInfo":{"status":"ok","timestamp":1642777526561,"user_tz":-60,"elapsed":266,"user":{"displayName":"Mick Hekkema","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"14588855259162105764"}},"outputId":"ceaee2e0-0a62-4007-c70c-3bf9deddf38b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["<matplotlib.contour.QuadContourSet at 0x7f2420550390>"]},"metadata":{},"execution_count":24},{"output_type":"display_data","data":{"image/png":"iVBORw0KGgoAAAANSUhEUgAAALoAAAD4CAYAAABbnvyWAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAVmElEQVR4nO2dXYweV3nH/w921quarWUXs7X8tS1OLHxTUyKK1KgKhqA0Ny5SL5qL4guk7UUi8ZELLPUC1KvcADetUBclSlrR9AKIYlWoJXUgVqUKkVRpcBJiu8hxd9msHRVtVkL2Yufpxc4k45d3Zs7Hc855zsz5Sat9P2fOO/M7z/vMM+c9Q8yMQmHovC91AwqFGBTRC6OgiF4YBUX0wigoohdGwfaoK5vdyTvm9sRcZSfbrr/T+Txd/7Xzsnn2Duf3SnJrdjyx7FdvLb/FzHunPRdV9B1ze/Dhk1+Mucpedl263vn8zOsrzsvePLrf+b2SrB+ZTd0EK3Zduu7U5hcfe+SNtueiij42mp0kpfSu4sSmL+j4MJ7vtRZiCTDz+orXt4Mvuy5dDyqSD9PaJt3WEtF72Dy6X1TQvmWFjvzaonuszjf6iA7oymFjRH4NkT32N0wR3YAU+XVo4VOmMinWGzV1uTUDbByi1ufnrqQbYLZ+ZFZFpJuklj1UZ4uZyqTcvqoi+sYh6uwIYyZ0dA9N6iCiSvSaVLJ3RTYtNfFQhEplfJZr874+Z1SKDhTZpxGjPCklu2/HWT8ya5RSmWYBakXXSkrZY607dZphesxgEwxVi64xqgPpI3sMUsguHcWbqBY9JdpkT9G5YuTWgLnggHvwUy96yiqMphNJQ8RWcB8X1IueGs0HpzEIlcLYBBGJYFfGunhSyx6yIpK6Q0meVIoteE2J6AaY7JzUMobGNLJ3vS6V5EAR3ZhUsmvqQK618Zi5eBsldbHAZDyM5LBeTZI36UplfFKckIWHIrolprID7nm7VsFDVaFiVNbUi55yRGMbpiMdJ4WdJr5WqZuELLPGKh+rFl2j5DUuw3pzkHqSnKN4E7Wia5a8RusYdilSS37j8GbrczvemLFaZ6m6eDLUs6epJL9xePPdv77X2aAyoucQzZvUUgwluoeQ3ETwkPRGdCI6SEQ/JKJXiegVIvp89fgeInqWiC5W/3dLNCg3yZvY1Is1Eqr9oSS3eZ9J6nITwCPMfAzAxwE8RETHAJwGcJaZ7wRwtrrvhUbJXU5g5CR83dZQgndtO5MUpQ/T9/emLsy8CmC1ur1BRK8B2A/gJIB7q5c9CeBHAL5s39QtNEk+bedsHCLrNjbl0ZTWxOiEMVOVG4c3ew9OrXJ0IloA8BEAPwYwX3UCAHgTwHzLexYBLALA9l3TsxtNkgNb7ZEuf03KFUv82N8sJtstdD4+DWPRiej9AL4L4AvM/DbRex+ImZmIptrKzEsAlgBgdv/B33iNNslr6nbVO066nSYCmnQGTSlSKslNSo1GohPRHdiS/NvM/L3q4TUi2sfMq0S0D8BVm8ZpFXyS1HPN5ILWSF5jUnUhAI8BeI2Zv9546gyAU9XtUwCeMV1pLpIX+jE5WJc46GzD9MSRSdXljwH8JYATRPRS9fcAgEcB3EdEFwF8qrrfybbNtJJrOiAcAqmjuM3ZUZOqy38AaPtEnzReU0S6hNY2m2yupJbcFpVnRl2x/RVMEd4NDZLbjnUZjOguaYlvdG/u8DEcd0gMxqpZOHANAHB5eeolh8TJXnTfvFsqumudJViKEJJP3jaV3jaaA5mPXpQ8uLRdls0JpdxnCJaUvIum9NJkKXrImV9NmbvCxpE654geopNOi9yXl/caRXSXaA5klrrEmsfbJo2ZJnGos6kxsRXcJ5pLCN63rbMQPXb92/cgNWfBgTipls1BaJfkpttadeoytuvsaMBF8lQnhWwCirqIrkmwsdXbhyo5oER0TXJPY+hnUzVWhSQlBxKKrl3uSYYqu4/kKQZquR7/RBV92/V3shO8yZBk943isSX3PcBXkbrkRCjZfcQzlUBjitIklOSA8qqLVkJ8K7nuzNxLmTW+kvftkxLRFTH58z2T16ZixxszYumLj+SmQadEdEdCHmv0DS9wkVxr2uIque05lhLRPQh9cBr6B9q++ER118qKa4AponsSoxKjTXAffEqHPt+i2Yk+TarUJcshlR1tMY3qPoOyJPavWtFtxEk1OdDkOovsbsNo2ySX3I+qRJe+xF9uox5DEeNAVFJwQH7fJRc9pBgphNcquzZiSg4kED2FBFon+5RAa0WmixipyiRRRb81m75sH1J6rZE8xKSpru1oI3QASp66pERSeq2S16SWPaXkwMhFb+JaudEiuMv87bFILTlQRG9Fi8CSxI7qIU8ATbJ+ZBZ4vv359ElzQQxNg8H6onjsokCJ6AVRYkbxGpNv3xLRR0ioqK5VcqBE9KzxuaiYzdh3k+X0kfr8RRE9U7oE7ZNX4qBUWvCZ11duu795dH/ve2wKBkX0TJCslsT4faotJmLXuFTE4p4ZnZHbYVprxpJoOJvpQ8qcfJJsI7p2CVw7ovbPlRKfcxvZiq6dIQqb86UoS3mxEATxs5499AWWInpBNRKSA2YX1H2ciK4S0fnGY18lopWJ644WBozWg3/TFNEkoj8B4P4pj3+DmY9Xf9+3aFuhYERXNDe5YnUTkwvqniOiBeMljoTJX767XltniEjk532S2+JTdXmYiD4L4AUAjzDzL6e9iIgWASwCwPZduz1Wp4O2qR2mPT4k+W1+srd+ZNZZ9r6c3LWa5Xow+k0AHwJwHMAqgK+1vZCZl5j5bma+e9vOnY6r04HtrFQ3Dm/e9jcETEVbPzJrPWVJKMkBx4jOzGv1bSL6FoB/cW5BBkhJ6rMcTd8ONr9m6ovuUlWVPpxEJ6J9zLxa3f0MgPNdr88ZLZHYtx3SHcVWdp/1SNArOhE9BeBeAB8gomUAXwFwLxEdB8AALgP4K5HWFIIR4hgi9O9UJc8um1RdHpzy8GNiLVCMlmgeCp9p5GpCyS49hKKMdWlh6JI3aX5WF+klZQ81RqiIXrgN1yjvK3voa5wW0acQMpovHLhm/R6by4lLcePwppPsNaEuIOa6b4rokXARvOu9MeT3yeGlUxDf4FNEj4CP5LbLDNEBXKK79Pp9KaIPjFAdQKJC47NeX4roI2GyA7iKH0t46eOkIvoUJK+hGSJtkaDZLhfpQwkfqhBQRC+8K30K4WOdryiiF95FQvhU9HW0InpAJNKWE/MXel/z3Npd3utp4iO8VoroLUjm6TaYiN33HinxFw5cy0J2k7SpiK4EF8FNluUr/VCiuwrRTU4Xx54QKHXOKUUtvYTwGmU3PQhOMq/L3BW+7a8gn2dPcmL+gve3hrZSqU2lJ6ro2zbd5weJ2SGkorltBAwtO+CfImmT3ZQyU1dgtMruI/zCgWvJhbet2xfRJxhKbm6CRHRPLbwpKg5GtRBK8svLe62EeG7tLtEqTBcn5i+IVWZcsf3WczkLWyJ6JDSmMDWxOlUbMb4VshI95AHpmFKWaUhUZXwwld11TE1WoociluSao3pNDrJPoy8Ijlr0FFPF5SB7SkKlMVmJLnV2NLe5EMcke1cgaEtbTFLabESXkDw3wZuMSfYQZCG6lOS5U2R3R73ovpLnHMWnEVr2lJ3JZdCYaSVOtegSkg+RMUZ239+mqhbdh6FKXvPc2l2DEj70EOBBij50yZtIyp5bx7E5gah2rItr2pKj5NOimdaxMSHoi+YSU2qoFd0FTZKbiNq1g5vPmSwrd9lDo1L0WDOsNkkx3NT052mmox/r1MNF+NzSFlvU5eg2kkuUDlOPqa7X39cGm4M1W2lzKym6oEp0W8l9SC34NGLLnrpy4yu56JWjY2HaaB/BtYk9jb50xuZHHBrTkVQzCaiI6EXy25GM7Bq4vLz33T9bpCYxTS66ieS+uXhOktcMQXZXuUPQKzoRPU5EV4nofOOxPUT0LBFdrP7vdlm5qeSuaMzDJdEi0SQxBTfNBkxy9CcA/C2Af2g8dhrAWWZ+lIhOV/e/LN04zVG8r4QnkR+blB9tf3gdEq0dDzC7oO45IlqYePgktq4mDQBPAvgRDEUPLbnkTvc5ASM18aep7PVrU6FZcsC96jLPzKvV7TcBzLe9kIgWASwCwPZdZhmOi+SxpmiWWLat9NInlqRJLblJ8PQuLzIzE1Hr6BpmXgKwBACz+w92jsIZouBd67MRXqvsoSWXuiKeq+hrRLSPmVeJaB+Aqz6NSCU4kPZX71Iz3aYiViSXkN21vHgGwKnq9ikAz7gsxKVsKFVJST2PSRPTdph+7hgCxk5XfM+Em5QXnwLwnwCOEtEyEX0OwKMA7iOiiwA+Vd03opY7leBA+pmppmHa8TTJnhMmVZcHW576pO3KeMZ+pi0tVZRYmMyFmDpfT9WJfFIYNWNdmoTYOTlIXqNZ9tTfFG2ZQFZXpQtVLQgh+Z/vetHodd9Z/6jT8iVmua2Rkj215F30pcJJRU999tIFU8Gnvd5W+j7Zba4r5Cu7ZslNiCr6zMzNaDVeacltBe9aho3wGmTPXXJAwejFEGiUfHJ5Nsvs+zyhg4eWsTQ+DE70nA46Y8vuI2zusg9KdA05ucvyTdfhI7uEqFplNznHMhjRc4rk0zAVvqQxW5j+qLxGVXnRlVCSh47mbet0LUm2IS1nisum+36GqKL/9vbrxlKa1JBzj+Jt9MluU4kJGYFDXTY9RJvVRvTUEqeI5pPrl5I9JL7RPVYqpFb0gozssUidu5+Yv4DnO54fzMGoJKmjeRNNbdGI6ajPInoGdMmeOsVLic1nL6IPgDHKbvuZi+hTkC7vSVBSmPdw6dhF9IEwlqju+jmL6C2UqK4Pn84cVfTd234Vc3WjY8hR3fezlYjeQYnqOpDowNFFH+OOisnQorrU5ykRvQeNUb3wm/QF0CSi5xbVtcnet/2GEtUlP0cS0bWJY8J31j+qpt1a2pET0Qd15b6Tmu3P7ZtpyGztl1+0Ph9V9F/e+q2YqwvOZKeNIX7ugSIVZZiuIG0SSnWAIrk7RfQIFEHTo1b05g8KhlJFKKRDXR192tWMc50ov+CH5H5XI3rf5bqL7AUfVIguLXHqa9wX9JE8R7cR8rm1uzrzdZOUp+T74ySZ6K4Rt0120+X1dRZJTNsk3Z4hfZvVn8V3GyUR3XdHNGV1WZbUxmtbru/7fNo1JMmb+O6zqKK/fXNWbEdILMdn44UUyrW0OlTJm7hum+Q5ugY0C6K5bamxkV5F1aVQ8KUvIHhFdCK6DGADwC0AN5n5bp/lDZW+eQlTT+fWJPYl1mMhkbp8gpnfEljOoLCZdHPytSlEa7aheXso0pccPQC+s9jGmPK5uR4NbQmNr+gM4AdExAD+npmXBNqULdLTNIeUzLatGr51fPAV/R5mXiGiDwJ4loh+xsznmi8gokUAiwCw44NznqvTS8i5yKVTCYm2mi5DS4fwEp2ZV6r/V4noaQAfA3Bu4jVLAJYAYO7o77LP+rRiI07zUt59VzvuWlcu1wu1WWfITuEsOhHtBPA+Zt6obn8awN+ItSwTTHfktGvVTz5mI76N8LlcELetnRIdwCeizwN4mojq5fwTM/+rd4sywkSgaYL3vdZF+CEj8RmdRWfmnwP4A+8WZIq05JPvc0lrCu2UM6OBcJW8+X7fZRTeo4juQF80lxS0CC9DEd2SmJJPLrcI704R3QINB35FeDeK6IaEPPh0oQhvRxHdAGnJ564w5q7InDsrwptRBnX1EDJdacq+cYi8luVz8qlvWb5oKJUW0TuImZPX0vsKX6Mpyre1JWYHKKnLFC4v73Uev+KLVEqTAzE7YxF9Ag2VlbHJHkP4InqFbRSvCbWTxiQ7ED66jzZH1xC5+5i7wmI5ew64DGozZVSiS8vtEoVsI/XYZAfCDGobRerimpZ04fpV6yKtZN09F6RTmUFH9BzSExsk6+7akY7ogxM9hty+0aaW1CdKS9fdNVFy9A5iRW/Jr9SNQ+SdkgxZeBsWDlzDGx3PZ5+jh8i/2whRApMSdGw5vC1ZRvQUuXfIOq9EKtN8f87R3SVtMfnxdDaipzywjHWqWiKVAYYhvCmmMwSoFn0Mck8iJTswzhp8GypFTyW4phF/UuQU3W3TFpv5XlSJHltwrWJLRvWaoUV320mNVIgeU3CtcsdgaLLbkFT0nMuCuaJVdtu0xXYOyuiil+idHq2yu2B6hY6oJ4w2N+P0q/KD4X40DRTzPeVvEjxV5OhSFLntyakq00Wf7IMQvQjuz9BHRmY91qWkKGGImdLEmgkgm4geUmjTHTvESNfGkA5YAYWix4rQLlFrKPmsKUP6vMlFj516SA6aAoYhQR9DiO7RRU+ZU4fIPUNIoKXsF4NYV/eIejBKm+miQkh5JGvSWiUP2a4YRYWsqy6mxJLHR3hNJ3BSEVL25Dl6aFLIY5PDj13uSbpkr1Mclw4xaNE1SNQmvYa25YZPxB+s6C4i7bp0vfW59SOzPs0BUOROiVeOTkT3E9HrRHSJiE5LNcoXacnr5+u/Qn74XCJ9G4C/A3AfgGUAPyGiM8z8qlTjbPCJlrby1q+XiPKFOPhE9I8BuMTMP2fmTQD/DOCkTLPM8a1W+EToEt3zwSdH3w/gfxv3lwH80eSLiGgRwGJ198aFr3zpvMc6JfgAgLfElva8gja4McQ2HG57IvjBKDMvAVgCACJ6gZnvDr3OLkobxtkGn9RlBcDBxv0D1WOFgjp8RP8JgDuJ6PeIaAbAXwA4I9OsQkEW59SFmW8S0cMA/g3ANgCPM/MrPW9bcl2fIKUNW4yqDcRcTmIUhs8oBnUVCkX0wiiIIrqWoQJEdJmIfkpELxHRC5HW+TgRXSWi843H9hDRs0R0sfq/O0EbvkpEK9W2eImIHgjchoNE9EMiepWIXiGiz1ePR9kWwUVvDBX4UwDHADxIRMdCr7eDTzDz8Yg15CcA3D/x2GkAZ5n5TgBnq/ux2wAA36i2xXFm/n7gNtwE8AgzHwPwcQAPVR5E2RYxIrqKoQKpYOZzAP5v4uGTAJ6sbj8J4M8StCEqzLzKzP9V3d4A8Bq2zq5H2RYxRJ82VGB/hPVOgwH8gIherIYmpGKemVer228CmE/UjoeJ6OUqtQmaPjUhogUAHwHwY0TaFmM7GL2Hmf8QW2nUQ0T0J6kbxFv13RQ13m8C+BCA4wBWAXwtxkqJ6P0AvgvgC8z8dvO5kNsihuhqhgow80r1/yqAp7GVVqVgjYj2AUD1/2rsBjDzGjPfYuZ3AHwLEbYFEd2BLcm/zczfqx6Osi1iiK5iqAAR7SSiufo2gE8DSDWS8gyAU9XtUwCeid2AWq6KzyDwtiAiAvAYgNeY+euNp+JsC2YO/gfgAQAXAPwPgL+Osc4pbfh9AP9d/b0Sqx0AnsJWavBrbB2ffA7A72CrwnARwL8D2JOgDf8I4KcAXq5k2xe4DfdgKy15GcBL1d8DsbZFGQJQGAVjOxgtjJQiemEUFNELo6CIXhgFRfTCKCiiF0ZBEb0wCv4fVSpCgige+g4AAAAASUVORK5CYII=\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"needs_background":"light"}}],"source":["# visualization of the dataset\n","%matplotlib inline\n","fig = plt.figure()\n","ax = fig.add_subplot(121)\n","ax.contourf(u_all[50,:,:,0])\n","# ax2 = fig.add_subplot(122)\n","# ax2.contourf(u_all[0,:,:,1])"]},{"cell_type":"markdown","metadata":{"id":"uETvu-zSmX8h"},"source":["# 3. Prepare dataset"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CnZ8arjfmX8h"},"outputs":[],"source":["val_ratio = int(np.round(0.75*len(u_all)))\n","test_ratio = int(np.round(0.95*len(u_all)))\n","\n","u_train = u_all[:val_ratio,:,:,:].astype('float32')\n","u_val = u_all[val_ratio:test_ratio,:,:,:].astype('float32')\n","u_test = u_all[test_ratio:,:,:,:].astype('float32')\n","#del u_all\n"]},{"cell_type":"markdown","metadata":{"id":"ATy7X-ktmX8i"},"source":["# 4. Define the network"]},{"cell_type":"code","execution_count":null,"metadata":{"scrolled":true,"id":"08DdZ4I7mX8i","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1642777530467,"user_tz":-60,"elapsed":535,"user":{"displayName":"Mick Hekkema","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"14588855259162105764"}},"outputId":"12388f61-518b-4b38-abbf-34ea52deb776"},"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"model_13\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," input_9 (InputLayer)        [(None, 24, 24, 1)]       0         \n","                                                                 \n"," conv2d_16 (Conv2D)          (None, 24, 24, 512)       5120      \n","                                                                 \n"," max_pooling2d_16 (MaxPoolin  (None, 12, 12, 512)      0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_17 (Conv2D)          (None, 12, 12, 256)       1179904   \n","                                                                 \n"," max_pooling2d_17 (MaxPoolin  (None, 6, 6, 256)        0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_18 (Conv2D)          (None, 6, 6, 128)         295040    \n","                                                                 \n"," max_pooling2d_18 (MaxPoolin  (None, 3, 3, 128)        0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_19 (Conv2D)          (None, 3, 3, 64)          73792     \n","                                                                 \n"," max_pooling2d_19 (MaxPoolin  (None, 1, 1, 64)         0         \n"," g2D)                                                            \n","                                                                 \n","=================================================================\n","Total params: 1,553,856\n","Trainable params: 1,553,856\n","Non-trainable params: 0\n","_________________________________________________________________\n","Model: \"model_14\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," input_10 (InputLayer)       [(None, 1, 1, 64)]        0         \n","                                                                 \n"," conv2d_transpose_21 (Conv2D  multiple                 73856     \n"," Transpose)                                                      \n","                                                                 \n"," up_sampling2d_17 (UpSamplin  multiple                 0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_transpose_22 (Conv2D  multiple                 295168    \n"," Transpose)                                                      \n","                                                                 \n"," up_sampling2d_18 (UpSamplin  multiple                 0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_transpose_23 (Conv2D  multiple                 1180160   \n"," Transpose)                                                      \n","                                                                 \n"," up_sampling2d_19 (UpSamplin  multiple                 0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_transpose_24 (Conv2D  multiple                 4609      \n"," Transpose)                                                      \n","                                                                 \n","=================================================================\n","Total params: 1,553,793\n","Trainable params: 1,553,793\n","Non-trainable params: 0\n","_________________________________________________________________\n","Model: \"model_12\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," input_9 (InputLayer)        [(None, 24, 24, 1)]       0         \n","                                                                 \n"," conv2d_16 (Conv2D)          (None, 24, 24, 512)       5120      \n","                                                                 \n"," max_pooling2d_16 (MaxPoolin  (None, 12, 12, 512)      0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_17 (Conv2D)          (None, 12, 12, 256)       1179904   \n","                                                                 \n"," max_pooling2d_17 (MaxPoolin  (None, 6, 6, 256)        0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_18 (Conv2D)          (None, 6, 6, 128)         295040    \n","                                                                 \n"," max_pooling2d_18 (MaxPoolin  (None, 3, 3, 128)        0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_19 (Conv2D)          (None, 3, 3, 64)          73792     \n","                                                                 \n"," max_pooling2d_19 (MaxPoolin  (None, 1, 1, 64)         0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_transpose_20 (Conv2D  (None, 1, 1, 64)         36928     \n"," Transpose)                                                      \n","                                                                 \n"," up_sampling2d_16 (UpSamplin  (None, 3, 3, 64)         0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_transpose_21 (Conv2D  multiple                 73856     \n"," Transpose)                                                      \n","                                                                 \n"," up_sampling2d_17 (UpSamplin  multiple                 0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_transpose_22 (Conv2D  multiple                 295168    \n"," Transpose)                                                      \n","                                                                 \n"," up_sampling2d_18 (UpSamplin  multiple                 0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_transpose_23 (Conv2D  multiple                 1180160   \n"," Transpose)                                                      \n","                                                                 \n"," up_sampling2d_19 (UpSamplin  multiple                 0         \n"," g2D)                                                            \n","                                                                 \n"," conv2d_transpose_24 (Conv2D  multiple                 4609      \n"," Transpose)                                                      \n","                                                                 \n","=================================================================\n","Total params: 3,144,577\n","Trainable params: 3,144,577\n","Non-trainable params: 0\n","_________________________________________________________________\n"]}],"source":["input_img = Input(shape=(Nx,Nx,Nu))\n","\n","nb_layer = 0\n","\n","act = 'tanh'\n","\n","x = Conv2D(512,(3,3), padding='same', activation=act)(input_img)\n","x = MaxPool2D((2,2), padding='same')(x)\n","x = Conv2D(256,(3,3), padding='same', activation=act)(x)\n","x = MaxPool2D((2,2), padding='same')(x)\n","x = Conv2D(128,(3,3), padding='same', activation=act)(x)\n","x = MaxPool2D((2,2), padding='same')(x)\n","x = Conv2D(64,(3,3), padding='same', activation=act)(x)\n","encoded = MaxPool2D((3,3), padding='same')(x)\n","\n","x = Conv2DTranspose(64,(3,3), padding='same', activation=act)(encoded)\n","x = UpSampling2D((3,3))(x)\n","x = Conv2DTranspose(128,(3,3), padding='same', activation=act)(x)\n","x = UpSampling2D((2,2))(x)\n","x = Conv2DTranspose(256,(3,3), padding='same', activation=act)(x)\n","x = UpSampling2D((2,2))(x)\n","x = Conv2DTranspose(512,(3,3), padding='same', activation=act)(x)\n","x = UpSampling2D((2,2))(x)\n","decoded = Conv2DTranspose(Nu,(3,3), activation='linear', padding='same')(x)\n","\n","autoencoder = tf.keras.models.Model(input_img,decoded)\n","encoder = tf.keras.models.Model(input_img,encoded)\n","\n","# definition of the decoder\n","encoded_input = Input(shape=(1,1,encoded.shape[3]))\n","deco = autoencoder.layers[-7](encoded_input) # we re-use the same layers as the ones of the autoencoder\n","for i in range(6):\n","    deco = autoencoder.layers[-6+i](deco)\n","\n","decoder = tf.keras.models.Model(encoded_input,deco)\n","\n","encoder.summary()\n","decoder.summary()\n","autoencoder.summary()"]},{"cell_type":"markdown","metadata":{"id":"fWxyxA25mX8j"},"source":["# 5. Training the Network\n","We use the difference between the network output and the real image to calculate or cost/loss function. As an optimizier we choose the AdamOptimizer and tell it which function value to minimize"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oQ8r_MxpmX8j"},"outputs":[],"source":["autoencoder.compile(optimizer=Adam(learning_rate=0.0001),loss='mse')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ngi45OSXmX8k"},"outputs":[],"source":["checkpoint_filepath = './checkpoint'\n","model_checkpoint_callback = tf.keras.callbacks.ModelCheckpoint(\n","    filepath=checkpoint_filepath,\n","    save_weights_only=True,\n","    monitor='val_loss',\n","    mode='min',\n","    save_best_only=True)\n","early_stop_callback = tf.keras.callbacks.EarlyStopping(monitor='val_loss', patience=10)"]},{"cell_type":"code","execution_count":null,"metadata":{"scrolled":true,"id":"a3XkdF-KmX8k","colab":{"base_uri":"https://localhost:8080/"},"outputId":"2f5ef650-9f40-43f0-f89f-3d6547eb5d05","executionInfo":{"status":"ok","timestamp":1642777756521,"user_tz":-60,"elapsed":206769,"user":{"displayName":"Mick Hekkema","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"14588855259162105764"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/1000\n","38/38 [==============================] - 2s 27ms/step - loss: 0.0425 - val_loss: 0.0157\n","Epoch 2/1000\n","38/38 [==============================] - 1s 23ms/step - loss: 0.0123 - val_loss: 0.0109\n","Epoch 3/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0079 - val_loss: 0.0059\n","Epoch 4/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0050 - val_loss: 0.0040\n","Epoch 5/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0044 - val_loss: 0.0038\n","Epoch 6/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0042 - val_loss: 0.0036\n","Epoch 7/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0041 - val_loss: 0.0036\n","Epoch 8/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0040 - val_loss: 0.0035\n","Epoch 9/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0040 - val_loss: 0.0033\n","Epoch 10/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0039 - val_loss: 0.0033\n","Epoch 11/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0038 - val_loss: 0.0032\n","Epoch 12/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0038 - val_loss: 0.0032\n","Epoch 13/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0037 - val_loss: 0.0031\n","Epoch 14/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0037 - val_loss: 0.0031\n","Epoch 15/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0036 - val_loss: 0.0031\n","Epoch 16/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0036 - val_loss: 0.0030\n","Epoch 17/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0036 - val_loss: 0.0030\n","Epoch 18/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 0.0035 - val_loss: 0.0029\n","Epoch 19/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0036 - val_loss: 0.0031\n","Epoch 20/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 0.0035 - val_loss: 0.0029\n","Epoch 21/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0035 - val_loss: 0.0028\n","Epoch 22/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0035 - val_loss: 0.0029\n","Epoch 23/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0034 - val_loss: 0.0030\n","Epoch 24/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0033 - val_loss: 0.0028\n","Epoch 25/1000\n","38/38 [==============================] - 1s 24ms/step - loss: 0.0033 - val_loss: 0.0027\n","Epoch 26/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0032 - val_loss: 0.0029\n","Epoch 27/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0033 - val_loss: 0.0027\n","Epoch 28/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0033 - val_loss: 0.0028\n","Epoch 29/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0034 - val_loss: 0.0027\n","Epoch 30/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0033 - val_loss: 0.0027\n","Epoch 31/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0031 - val_loss: 0.0026\n","Epoch 32/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0030 - val_loss: 0.0025\n","Epoch 33/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0030 - val_loss: 0.0026\n","Epoch 34/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0030 - val_loss: 0.0025\n","Epoch 35/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0029 - val_loss: 0.0025\n","Epoch 36/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0029 - val_loss: 0.0025\n","Epoch 37/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0029 - val_loss: 0.0024\n","Epoch 38/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0028 - val_loss: 0.0025\n","Epoch 39/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0029 - val_loss: 0.0024\n","Epoch 40/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0028 - val_loss: 0.0024\n","Epoch 41/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0027 - val_loss: 0.0024\n","Epoch 42/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0027 - val_loss: 0.0024\n","Epoch 43/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0027 - val_loss: 0.0023\n","Epoch 44/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0027 - val_loss: 0.0023\n","Epoch 45/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0027 - val_loss: 0.0024\n","Epoch 46/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0028 - val_loss: 0.0023\n","Epoch 47/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0026 - val_loss: 0.0022\n","Epoch 48/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0026 - val_loss: 0.0023\n","Epoch 49/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0026 - val_loss: 0.0023\n","Epoch 50/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0026 - val_loss: 0.0022\n","Epoch 51/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0027 - val_loss: 0.0035\n","Epoch 52/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0032 - val_loss: 0.0023\n","Epoch 53/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0025 - val_loss: 0.0022\n","Epoch 54/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0024 - val_loss: 0.0021\n","Epoch 55/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0024 - val_loss: 0.0021\n","Epoch 56/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0024 - val_loss: 0.0021\n","Epoch 57/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0023 - val_loss: 0.0020\n","Epoch 58/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0023 - val_loss: 0.0020\n","Epoch 59/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0023 - val_loss: 0.0020\n","Epoch 60/1000\n","38/38 [==============================] - 1s 23ms/step - loss: 0.0022 - val_loss: 0.0020\n","Epoch 61/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0022 - val_loss: 0.0019\n","Epoch 62/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0022 - val_loss: 0.0019\n","Epoch 63/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0022 - val_loss: 0.0019\n","Epoch 64/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0022 - val_loss: 0.0019\n","Epoch 65/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0021 - val_loss: 0.0019\n","Epoch 66/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0021 - val_loss: 0.0020\n","Epoch 67/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0022 - val_loss: 0.0018\n","Epoch 68/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0021 - val_loss: 0.0018\n","Epoch 69/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0021 - val_loss: 0.0019\n","Epoch 70/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0020 - val_loss: 0.0018\n","Epoch 71/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0020 - val_loss: 0.0018\n","Epoch 72/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0020 - val_loss: 0.0018\n","Epoch 73/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0020 - val_loss: 0.0017\n","Epoch 74/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0019 - val_loss: 0.0017\n","Epoch 75/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0019 - val_loss: 0.0017\n","Epoch 76/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 0.0019 - val_loss: 0.0017\n","Epoch 77/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0019 - val_loss: 0.0017\n","Epoch 78/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0019 - val_loss: 0.0017\n","Epoch 79/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0019 - val_loss: 0.0017\n","Epoch 80/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0019 - val_loss: 0.0019\n","Epoch 81/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0025 - val_loss: 0.0026\n","Epoch 82/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0023 - val_loss: 0.0018\n","Epoch 83/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0018 - val_loss: 0.0016\n","Epoch 84/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0018 - val_loss: 0.0016\n","Epoch 85/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0018 - val_loss: 0.0016\n","Epoch 86/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0017 - val_loss: 0.0015\n","Epoch 87/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0017 - val_loss: 0.0015\n","Epoch 88/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0017 - val_loss: 0.0015\n","Epoch 89/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0017 - val_loss: 0.0015\n","Epoch 90/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0017 - val_loss: 0.0015\n","Epoch 91/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 0.0017 - val_loss: 0.0015\n","Epoch 92/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0017 - val_loss: 0.0015\n","Epoch 93/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0016 - val_loss: 0.0015\n","Epoch 94/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0016 - val_loss: 0.0015\n","Epoch 95/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0016 - val_loss: 0.0014\n","Epoch 96/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0016 - val_loss: 0.0014\n","Epoch 97/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0016 - val_loss: 0.0014\n","Epoch 98/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0015 - val_loss: 0.0014\n","Epoch 99/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0015 - val_loss: 0.0014\n","Epoch 100/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 0.0015 - val_loss: 0.0014\n","Epoch 101/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0015 - val_loss: 0.0014\n","Epoch 102/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0015 - val_loss: 0.0014\n","Epoch 103/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0016 - val_loss: 0.0015\n","Epoch 104/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0016 - val_loss: 0.0014\n","Epoch 105/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0015 - val_loss: 0.0014\n","Epoch 106/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 0.0015 - val_loss: 0.0013\n","Epoch 107/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0014 - val_loss: 0.0013\n","Epoch 108/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0014 - val_loss: 0.0013\n","Epoch 109/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0014 - val_loss: 0.0013\n","Epoch 110/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0014 - val_loss: 0.0014\n","Epoch 111/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0014 - val_loss: 0.0014\n","Epoch 112/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0014 - val_loss: 0.0013\n","Epoch 113/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0014 - val_loss: 0.0013\n","Epoch 114/1000\n","38/38 [==============================] - 1s 23ms/step - loss: 0.0014 - val_loss: 0.0012\n","Epoch 115/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0014 - val_loss: 0.0014\n","Epoch 116/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0014 - val_loss: 0.0013\n","Epoch 117/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0014 - val_loss: 0.0013\n","Epoch 118/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0014 - val_loss: 0.0012\n","Epoch 119/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0013 - val_loss: 0.0012\n","Epoch 120/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0013 - val_loss: 0.0012\n","Epoch 121/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0013 - val_loss: 0.0012\n","Epoch 122/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0013 - val_loss: 0.0012\n","Epoch 123/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0013 - val_loss: 0.0012\n","Epoch 124/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0013 - val_loss: 0.0012\n","Epoch 125/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0013 - val_loss: 0.0012\n","Epoch 126/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0013 - val_loss: 0.0012\n","Epoch 127/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0012 - val_loss: 0.0012\n","Epoch 128/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0012 - val_loss: 0.0012\n","Epoch 129/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0012 - val_loss: 0.0012\n","Epoch 130/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0012 - val_loss: 0.0012\n","Epoch 131/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0013 - val_loss: 0.0012\n","Epoch 132/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 0.0012 - val_loss: 0.0011\n","Epoch 133/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0012 - val_loss: 0.0012\n","Epoch 134/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0013 - val_loss: 0.0012\n","Epoch 135/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0013 - val_loss: 0.0011\n","Epoch 136/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0013 - val_loss: 0.0012\n","Epoch 137/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0012 - val_loss: 0.0011\n","Epoch 138/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0012 - val_loss: 0.0011\n","Epoch 139/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0012 - val_loss: 0.0011\n","Epoch 140/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 0.0012 - val_loss: 0.0011\n","Epoch 141/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 0.0011 - val_loss: 0.0011\n","Epoch 142/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0011 - val_loss: 0.0011\n","Epoch 143/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0012 - val_loss: 0.0011\n","Epoch 144/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0012 - val_loss: 0.0011\n","Epoch 145/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0012 - val_loss: 0.0011\n","Epoch 146/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0012 - val_loss: 0.0011\n","Epoch 147/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0011 - val_loss: 0.0011\n","Epoch 148/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 0.0011 - val_loss: 0.0010\n","Epoch 149/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 0.0011 - val_loss: 0.0011\n","Epoch 150/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0011 - val_loss: 0.0010\n","Epoch 151/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0011 - val_loss: 0.0010\n","Epoch 152/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0011 - val_loss: 0.0011\n","Epoch 153/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0012 - val_loss: 0.0011\n","Epoch 154/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0011 - val_loss: 0.0010\n","Epoch 155/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0011 - val_loss: 9.9663e-04\n","Epoch 156/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0011 - val_loss: 0.0011\n","Epoch 157/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0010 - val_loss: 9.8119e-04\n","Epoch 158/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 0.0010 - val_loss: 9.6741e-04\n","Epoch 159/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 0.0010 - val_loss: 9.7515e-04\n","Epoch 160/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 9.9873e-04 - val_loss: 9.6172e-04\n","Epoch 161/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 9.9579e-04 - val_loss: 9.5340e-04\n","Epoch 162/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 9.8920e-04 - val_loss: 9.7111e-04\n","Epoch 163/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 9.9824e-04 - val_loss: 9.9840e-04\n","Epoch 164/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 9.7534e-04 - val_loss: 9.6498e-04\n","Epoch 165/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 9.8625e-04 - val_loss: 9.2991e-04\n","Epoch 166/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 9.6057e-04 - val_loss: 9.2914e-04\n","Epoch 167/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 9.4732e-04 - val_loss: 9.4621e-04\n","Epoch 168/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 9.4501e-04 - val_loss: 0.0011\n","Epoch 169/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 9.6713e-04 - val_loss: 9.9096e-04\n","Epoch 170/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 9.5244e-04 - val_loss: 9.0575e-04\n","Epoch 171/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 9.1576e-04 - val_loss: 9.2480e-04\n","Epoch 172/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 9.0482e-04 - val_loss: 9.2044e-04\n","Epoch 173/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 9.0520e-04 - val_loss: 9.1523e-04\n","Epoch 174/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 9.1073e-04 - val_loss: 9.0352e-04\n","Epoch 175/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 9.5701e-04 - val_loss: 9.1872e-04\n","Epoch 176/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 9.2318e-04 - val_loss: 8.9354e-04\n","Epoch 177/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 9.2105e-04 - val_loss: 9.9465e-04\n","Epoch 178/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 9.3770e-04 - val_loss: 9.1784e-04\n","Epoch 179/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 8.7594e-04 - val_loss: 8.7299e-04\n","Epoch 180/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 8.5497e-04 - val_loss: 8.5359e-04\n","Epoch 181/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 8.4629e-04 - val_loss: 8.6351e-04\n","Epoch 182/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 8.6256e-04 - val_loss: 8.6940e-04\n","Epoch 183/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 8.8294e-04 - val_loss: 8.8297e-04\n","Epoch 184/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 8.8479e-04 - val_loss: 8.8014e-04\n","Epoch 185/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 8.5867e-04 - val_loss: 8.6968e-04\n","Epoch 186/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 8.2081e-04 - val_loss: 8.3444e-04\n","Epoch 187/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 8.1132e-04 - val_loss: 8.2864e-04\n","Epoch 188/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 7.9947e-04 - val_loss: 8.2219e-04\n","Epoch 189/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 7.9803e-04 - val_loss: 8.5090e-04\n","Epoch 190/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.9619e-04 - val_loss: 8.4809e-04\n","Epoch 191/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.9272e-04 - val_loss: 8.6034e-04\n","Epoch 192/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 8.1057e-04 - val_loss: 8.7322e-04\n","Epoch 193/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 7.8295e-04 - val_loss: 8.0669e-04\n","Epoch 194/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.6141e-04 - val_loss: 8.1252e-04\n","Epoch 195/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 7.5245e-04 - val_loss: 8.0141e-04\n","Epoch 196/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.4604e-04 - val_loss: 8.3352e-04\n","Epoch 197/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.5369e-04 - val_loss: 8.0407e-04\n","Epoch 198/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.5243e-04 - val_loss: 8.2300e-04\n","Epoch 199/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 7.3358e-04 - val_loss: 7.9737e-04\n","Epoch 200/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.2698e-04 - val_loss: 7.9862e-04\n","Epoch 201/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.3090e-04 - val_loss: 8.2425e-04\n","Epoch 202/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.5289e-04 - val_loss: 8.2499e-04\n","Epoch 203/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.6677e-04 - val_loss: 8.5740e-04\n","Epoch 204/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 7.5700e-04 - val_loss: 8.0547e-04\n","Epoch 205/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 7.1140e-04 - val_loss: 7.8110e-04\n","Epoch 206/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 7.0650e-04 - val_loss: 7.6755e-04\n","Epoch 207/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.9266e-04 - val_loss: 7.7022e-04\n","Epoch 208/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.1042e-04 - val_loss: 7.7271e-04\n","Epoch 209/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 7.0618e-04 - val_loss: 7.8307e-04\n","Epoch 210/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 6.9273e-04 - val_loss: 7.6674e-04\n","Epoch 211/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 6.7737e-04 - val_loss: 7.5500e-04\n","Epoch 212/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 6.7381e-04 - val_loss: 7.5061e-04\n","Epoch 213/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.6926e-04 - val_loss: 7.6029e-04\n","Epoch 214/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.6208e-04 - val_loss: 7.5067e-04\n","Epoch 215/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.5386e-04 - val_loss: 7.5115e-04\n","Epoch 216/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.5797e-04 - val_loss: 7.7641e-04\n","Epoch 217/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.6620e-04 - val_loss: 7.6329e-04\n","Epoch 218/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 6.6834e-04 - val_loss: 7.4636e-04\n","Epoch 219/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.7437e-04 - val_loss: 7.6788e-04\n","Epoch 220/1000\n","38/38 [==============================] - 1s 16ms/step - loss: 6.7592e-04 - val_loss: 8.0739e-04\n","Epoch 221/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.9769e-04 - val_loss: 7.7167e-04\n","Epoch 222/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.8993e-04 - val_loss: 8.0541e-04\n","Epoch 223/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.5038e-04 - val_loss: 7.5099e-04\n","Epoch 224/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 6.3318e-04 - val_loss: 7.2848e-04\n","Epoch 225/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 6.2029e-04 - val_loss: 7.2237e-04\n","Epoch 226/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 6.1020e-04 - val_loss: 7.1773e-04\n","Epoch 227/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 6.0712e-04 - val_loss: 7.0811e-04\n","Epoch 228/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 6.0820e-04 - val_loss: 7.2252e-04\n","Epoch 229/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.0465e-04 - val_loss: 7.0837e-04\n","Epoch 230/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 5.9682e-04 - val_loss: 7.0497e-04\n","Epoch 231/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 5.9606e-04 - val_loss: 7.0005e-04\n","Epoch 232/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.9715e-04 - val_loss: 7.0454e-04\n","Epoch 233/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.9715e-04 - val_loss: 7.2413e-04\n","Epoch 234/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.0013e-04 - val_loss: 7.0049e-04\n","Epoch 235/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.9036e-04 - val_loss: 7.0073e-04\n","Epoch 236/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.8922e-04 - val_loss: 7.1136e-04\n","Epoch 237/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.1148e-04 - val_loss: 7.1109e-04\n","Epoch 238/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.0419e-04 - val_loss: 7.0450e-04\n","Epoch 239/1000\n","38/38 [==============================] - 1s 19ms/step - loss: 5.9025e-04 - val_loss: 6.8001e-04\n","Epoch 240/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.8421e-04 - val_loss: 6.9590e-04\n","Epoch 241/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.8759e-04 - val_loss: 7.1604e-04\n","Epoch 242/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.1697e-04 - val_loss: 7.0112e-04\n","Epoch 243/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 6.0295e-04 - val_loss: 7.2150e-04\n","Epoch 244/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.8601e-04 - val_loss: 6.9455e-04\n","Epoch 245/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.9329e-04 - val_loss: 6.8681e-04\n","Epoch 246/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.9486e-04 - val_loss: 7.1537e-04\n","Epoch 247/1000\n","38/38 [==============================] - 1s 25ms/step - loss: 5.7764e-04 - val_loss: 6.6221e-04\n","Epoch 248/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.6060e-04 - val_loss: 6.8200e-04\n","Epoch 249/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.5556e-04 - val_loss: 6.6350e-04\n","Epoch 250/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.6750e-04 - val_loss: 6.8933e-04\n","Epoch 251/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.4882e-04 - val_loss: 6.6367e-04\n","Epoch 252/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.4216e-04 - val_loss: 6.9540e-04\n","Epoch 253/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.5744e-04 - val_loss: 6.6368e-04\n","Epoch 254/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 5.3696e-04 - val_loss: 6.5804e-04\n","Epoch 255/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.3113e-04 - val_loss: 6.5870e-04\n","Epoch 256/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 5.2739e-04 - val_loss: 6.5059e-04\n","Epoch 257/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.3134e-04 - val_loss: 6.7154e-04\n","Epoch 258/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.4329e-04 - val_loss: 6.9331e-04\n","Epoch 259/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.5252e-04 - val_loss: 7.1166e-04\n","Epoch 260/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.6125e-04 - val_loss: 6.7240e-04\n","Epoch 261/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.5015e-04 - val_loss: 6.7504e-04\n","Epoch 262/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.4259e-04 - val_loss: 6.5602e-04\n","Epoch 263/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 5.2162e-04 - val_loss: 6.3799e-04\n","Epoch 264/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.1192e-04 - val_loss: 6.3944e-04\n","Epoch 265/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.1720e-04 - val_loss: 6.4877e-04\n","Epoch 266/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.1185e-04 - val_loss: 6.5449e-04\n","Epoch 267/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.0930e-04 - val_loss: 6.4057e-04\n","Epoch 268/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 5.0600e-04 - val_loss: 6.3413e-04\n","Epoch 269/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.0496e-04 - val_loss: 6.5948e-04\n","Epoch 270/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.3672e-04 - val_loss: 6.6392e-04\n","Epoch 271/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 5.2648e-04 - val_loss: 6.4718e-04\n","Epoch 272/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.1144e-04 - val_loss: 6.4636e-04\n","Epoch 273/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 5.0610e-04 - val_loss: 6.2891e-04\n","Epoch 274/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.0234e-04 - val_loss: 6.3993e-04\n","Epoch 275/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.1226e-04 - val_loss: 6.5831e-04\n","Epoch 276/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.3749e-04 - val_loss: 6.5900e-04\n","Epoch 277/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 5.2539e-04 - val_loss: 6.2544e-04\n","Epoch 278/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.4248e-04 - val_loss: 6.4555e-04\n","Epoch 279/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.0525e-04 - val_loss: 6.4452e-04\n","Epoch 280/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 5.0987e-04 - val_loss: 6.4264e-04\n","Epoch 281/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 4.9512e-04 - val_loss: 6.3300e-04\n","Epoch 282/1000\n","38/38 [==============================] - 1s 20ms/step - loss: 4.8991e-04 - val_loss: 6.1988e-04\n","Epoch 283/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 4.7961e-04 - val_loss: 6.2717e-04\n","Epoch 284/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 4.7936e-04 - val_loss: 6.1919e-04\n","Epoch 285/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 4.7547e-04 - val_loss: 6.1666e-04\n","Epoch 286/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 4.8216e-04 - val_loss: 6.4053e-04\n","Epoch 287/1000\n","38/38 [==============================] - 1s 21ms/step - loss: 4.8691e-04 - val_loss: 6.1294e-04\n","Epoch 288/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 4.8341e-04 - val_loss: 6.2474e-04\n","Epoch 289/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 4.8293e-04 - val_loss: 6.2553e-04\n","Epoch 290/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 4.7704e-04 - val_loss: 6.1812e-04\n","Epoch 291/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 4.7814e-04 - val_loss: 6.2241e-04\n","Epoch 292/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 4.8359e-04 - val_loss: 6.3705e-04\n","Epoch 293/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 4.8746e-04 - val_loss: 6.2223e-04\n","Epoch 294/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 4.7505e-04 - val_loss: 6.1406e-04\n","Epoch 295/1000\n","38/38 [==============================] - 1s 18ms/step - loss: 4.6939e-04 - val_loss: 6.1350e-04\n","Epoch 296/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 4.7021e-04 - val_loss: 6.1754e-04\n","Epoch 297/1000\n","38/38 [==============================] - 1s 17ms/step - loss: 4.7237e-04 - val_loss: 6.1747e-04\n"]}],"source":["nb_epochs = 1000\n","batch_size = 20\n","hist = autoencoder.fit(u_train, u_train, epochs=nb_epochs, batch_size=batch_size,\n","                shuffle=True,validation_data=(u_test, u_test),\n","                       verbose=1,\n","                       callbacks=[model_checkpoint_callback,early_stop_callback])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eGNNcjI5mX8k","colab":{"base_uri":"https://localhost:8080/","height":295},"executionInfo":{"status":"ok","timestamp":1642152028722,"user_tz":-60,"elapsed":2129,"user":{"displayName":"Mick Hekkema","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"14588855259162105764"}},"outputId":"a7062be6-e4dd-423e-a59c-54d43fa9f8f3"},"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"needs_background":"light"}}],"source":["loss_history = hist.history['loss']\n","val_history = hist.history['val_loss']\n","%matplotlib inline\n","plt.plot(loss_history,'b')\n","plt.plot(val_history,'r')\n","plt.title(\"Loss History\")\n","plt.xlabel(\"Epoch\")\n","plt.ylabel(\"Loss\")\n","\n","plt.show()"]},{"cell_type":"markdown","metadata":{"id":"HTyypK6EmX8k"},"source":["# 6. Visualization of some prediction cases"]},{"cell_type":"code","execution_count":null,"metadata":{"scrolled":true,"id":"ga9JB_OLmX8l","colab":{"base_uri":"https://localhost:8080/","height":300},"executionInfo":{"status":"ok","timestamp":1642152031738,"user_tz":-60,"elapsed":679,"user":{"displayName":"Mick Hekkema","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"14588855259162105764"}},"outputId":"050ff925-959a-4baf-edd9-704dd52f4a79"},"outputs":[{"output_type":"stream","name":"stdout","text":["(1, 24, 24, 1)\n"]},{"output_type":"execute_result","data":{"text/plain":["<matplotlib.contour.QuadContourSet at 0x7ff61e684f10>"]},"metadata":{},"execution_count":48},{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 2 Axes>"]},"metadata":{"needs_background":"light"}}],"source":["y_nn = autoencoder.predict(u_test[0:1,:,:,:])\n","print(y_nn.shape)\n","%matplotlib inline\n","fig = plt.figure()\n","ax = fig.add_subplot(121)\n","ax.contourf(y_nn[0,:,:,0])\n","ax = fig.add_subplot(122)\n","ax.contourf(u_test[0,:,:,0])\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_mz0SnncmX8l","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1642152038553,"user_tz":-60,"elapsed":239,"user":{"displayName":"Mick Hekkema","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"14588855259162105764"}},"outputId":"9b47ebe2-1380-4b30-f15e-3846b8e4645d"},"outputs":[{"output_type":"stream","name":"stdout","text":["AE error: 2.9932525649201125e-05\n"]}],"source":["print(f'AE error: {val_history[-1]}')"]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.5"},"colab":{"name":"AutoEncoder - Test document Mick ","provenance":[],"collapsed_sections":[]}},"nbformat":4,"nbformat_minor":0}